<?php
$escape = $this->plugin('escapeHtml');
$this->htmlElement('body')->appendAttribute('class', 'item resource show');
//$this->headLink()->appendStylesheet($this->assetUrl('css/lightslider.min.css'));
//$this->headLink()->appendStylesheet($this->assetUrl('css/lightgallery.min.css'));
//$this->headScript()->appendFile($this->assetUrl('js/lightslider.min.js'));
//$this->headScript()->appendFile($this->assetUrl('js/lightgallery.min.js'));
//$this->headScript()->appendFile($this->assetUrl('js/lg-video.min.js'));
//$this->headScript()->appendFile($this->assetUrl('js/lg-zoom.js'));

//$lightMedia = [];
//$otherMedia = [];
//foreach ($item->media() as $media) {
//    $mediaType = $media->mediaType();
//    $mediaRenderer = $media->renderer();
//    if ((strpos($mediaType, 'image/') !== false) || (strpos($mediaRenderer, 'youtube') !== false)) {
//        $lightMedia[] = $media;
//    } else {
//        $otherMedia[] = $media;
//    }
//}
?>

<?php 
//echo $this->pageTitle($item->displayTitle(), 2);
?>
<h2 style="padding-bottom:0px !important; ;margin-bottom:0px !important;"><?php echo $item->value('dcterms:title'); ?></h2>
<p style="font-size:0.9em;margin-top:0;padding-top:0;">
<a href="<?php echo $item->value('bibo:uri'); ?>"><?php echo $item->value('bibo:uri');?></a></p>

<p style="font-size:0.8em;margin-bottom:10px !important;padding-bottom:0 !important;">
&rarr; <a href="#viewer">View document with UniversalViewer</a> &nbsp;
<?php 
$hasVersion = $item->value('dcterms:hasVersion');
if($hasVersion) {
$uri = $hasVersion->uri();
echo '
&rarr; <a target="_blank" href="'.$uri.'">View document on Archive.org</a>
<img src="/themes/centerrow/asset/img/archive.png" style="height:15px;vertical-align:middle;">
 &nbsp;';
}
?>
&rarr; Re-use this digital object via a <a href="https://edisondigital.rutgers.edu/iiif/<?php echo $item->value('dcterms:identifier'); ?>">IIIF manifest</a> 
<img src="/themes/centerrow/asset/img/iiif.png" style="height:20px;vertical-align:middle;">
</p>

<!-- <h3><?php echo $this->translate('Item'); ?></h3> -->

<!--
<div style="display:block;width:100%;background-color:black;color:white;padding:10px;vertical-align:middle;margin-bottom:20px;">
<img src="https://img.icons8.com/metro/26/000000/images-folder.png"/>
<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
width="26" height="26"
viewBox="0 0 172 172"
style=" fill:#000000;"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><g fill="#ffffff"><path d="M19.84615,13.23077c-10.95673,0 -19.84615,8.88942 -19.84615,19.84615v112.46154c0,10.95673 8.88942,19.84615 19.84615,19.84615h132.30769c10.95673,0 19.84615,-8.88942 19.84615,-19.84615v-92.61538c0,-10.95673 -8.88942,-19.84615 -19.84615,-19.84615h-79.38462c0,-10.95673 -8.88942,-19.84615 -19.84615,-19.84615zM19.84615,46.30769h132.30769c3.64363,0 6.61538,2.97176 6.61538,6.61538v92.61538c0,3.64363 -2.97176,6.61538 -6.61538,6.61538h-132.30769c-3.64363,0 -6.61538,-2.97176 -6.61538,-6.61538v-92.61538c0,-3.64363 2.97176,-6.61538 6.61538,-6.61538zM72.76923,59.53846c-3.64363,0 -6.61538,2.97176 -6.61538,6.61538h-19.84615c-3.64363,0 -6.61538,2.97176 -6.61538,6.61538v52.92308c0,3.64363 2.97176,6.61538 6.61538,6.61538h79.38462c3.64363,0 6.61538,-2.97176 6.61538,-6.61538v-52.92308c0,-3.64363 -2.97176,-6.61538 -6.61538,-6.61538h-19.84615c0,-3.64363 -2.97176,-6.61538 -6.61538,-6.61538zM86,72.14904c14.98798,0 27.08173,12.09375 27.08173,27.08173c0,14.98798 -12.09375,27.08173 -27.08173,27.08173c-14.98798,0 -27.08173,-12.09375 -27.08173,-27.08173c0,-14.98798 12.09375,-27.08173 27.08173,-27.08173zM86,80.21154c-10.49158,0 -19.01923,8.52765 -19.01923,19.01923c0,10.49159 8.52765,19.01923 19.01923,19.01923c10.49159,0 19.01923,-8.52764 19.01923,-19.01923c0,-10.49158 -8.52764,-19.01923 -19.01923,-19.01923zM86,86.82692c6.79628,0 12.40385,5.60757 12.40385,12.40385c0,6.79628 -5.60757,12.40385 -12.40385,12.40385c-6.79628,0 -12.40385,-5.60757 -12.40385,-12.40385c0,-6.79628 5.60757,-12.40385 12.40385,-12.40385z"></path></g></g></svg>
<a target="_blank" style="color:white;text-decoration:underline;" href="/item/<?php echo $item->id(); ?>/play">View document images in UniversalViewer</a> or scroll to bottom of page
</div>
-->

<?php if (0): //count($lightMedia) > 0): ?>
<ul id="itemfiles" class="media-list">
    <?php foreach ($lightMedia as $media): ?>
        <?php $source = ($media->originalUrl()) ? $media->originalUrl() : $media->source(); ?>
        <li data-src="<?php echo $source; ?>" data-thumb="<?php echo $escape($media->thumbnailUrl('medium')); ?>" class="media resource">
            <?php echo $media->render(); ?>
        </li>
    <?php endforeach; ?>
</ul>
<?php endif; ?>


<!--
<div id="taep-transcribe" style="display:block;min-height:800px;width:40%;float:left;">
<iframe src="https://docs.google.com/forms/d/e/1FAIpQLScF5Hjwoj2lDX3VObuoYzrGsHFl0kfCUWKLskiNNVyIiPDvVA/viewform?embedded=true" width="100%" 
style="width:100%;height:100%;min-height:800px;" frameborder="0" marginheight="0" marginwidth="0">Loading...</iframe>
</div>
-->

<div style="clear:both;"></div>

<?php if (0): //(count($otherMedia) > 0): ?>
<div id="other-media" class="property">
    <h4><?php echo $this->translate('Other Media'); ?></h4>
    <div class="values">
        <?php foreach($otherMedia as $media): ?>
        <div class="value">
            <a href="<?php echo $media->siteUrl(); ?>"><?php echo $media->displayTitle(); ?></a>
        </div>
    </div>
    <?php endforeach; ?>
</div>
<?php endif; ?>

<?php
$page = $this->params()->fromQuery('page', 1);
$property = $this->params()->fromQuery('property');
$subjectValues = $item->displaySubjectValues($page, 25, $property);
?>
<?php if ($subjectValues): ?>
<div id="item-linked">
    <h3><?php echo $this->translate('Linked resources'); ?></h3>
    <?php echo $subjectValues; ?>
</div>
<?php endif; ?>


<div id="taep-metadata">
  <?php echo $item->displayValues(); ?>
  <?php $itemSets = $item->itemSets(); ?>
  <?php if (count($itemSets) > 0): ?>
  <div class="property">
    <h4><?php echo $this->translate('Item sets'); ?></h4>
    <div class="values">
        <?php foreach ($item->itemSets() as $itemSet): ?>
        <div class="value"><a href="<?php echo $escape($itemSet->url()); ?>"><?php echo $itemSet->displayTitle(); ?></a></div>
        <?php endforeach; ?>
    </div>
  </div>
  <?php endif; ?>
  <!--<div class="property"><h4>ID: </h4><div class="value"><?php echo $item->id(); ?></div></div>-->
</div>

<a id="viewer">
<?php 
  $options = array();
  echo $this->universalViewer($item, $options); 
?>
</a>

<?php

$trans = $item->value("scripto:transcription");
if(strlen($trans)>0) {
echo '&nbsp;<br><h3>Transcription</h3>';
echo '<div id="transcription">';
echo $trans->asHtml();
echo '</div>';
}

?>

<?php 
  //$this->trigger('view.show.after'); 
?>
<div style="display:block;width:65%;font-size:0.8em;">
<?php
echo 'Download <a href="/item/'.$item->value("dcterms:identifier").'.csv">CSV</a> | ';
echo '<a href="/item/'.$item->value("dcterms:identifier").'.json">JSON</a>';

//$exportArray=array("csv"=>"Download CSV");
//$bulkExportOptions = array("resourceType"=>"item", "exporters"=>$exportArray);
//$this->bulkExport($item, $bulkExportOptions);
?>
</div>
